{% extends "base.html" %}
{% block content %}
<div class="layout">
  <!-- LEWA KOLUMNA -->
  <div class="card pane">
    <div style="margin-bottom:10px"><strong>Filtry podstawowe</strong></div>

    <div class="filters">
      <div>
        <label>Rok</label>
        <select id="f-year">
          <option value="all">Wszystkie</option>
        </select>
      </div>
      <div>
        <label>Szukaj w tekście</label>
        <input id="f-q" type="text" placeholder="fraza..." />
      </div>
    </div>

    <div class="checks" style="margin-bottom:10px">
      <label class="check"><input id="f-reply" type="checkbox" /> bez reply</label>
      <label class="check"><input id="f-retweet" type="checkbox" /> bez retweet</label>
      <label class="check"><input id="f-quote" type="checkbox" /> bez quote</label>
    </div>
    <div>
      <label>Etykieta</label>
        <select id="f-label">
          <option value="all" selected>Wszystkie</option>
          <option value="up">up</option>
          <option value="down">down</option>
          <option value="neutral">neutral</option>
      </select>
    </div>

    <div style="margin: 6px 0 12px">
      <button id="btn-search" class="btn">Szukaj</button>
    </div>

    <!-- ETYKIETOWANIE -->
    <div class="card" style="padding:10px;margin-bottom:10px">
      <div style="margin-bottom:6px">
        <strong>Etykietowanie</strong>
      </div>
      <div class="filters" style="margin-bottom:8px">
        <div>
          <label>Minuta etykietowania</label>
          <select id="lab-min">
            {% for m in range(1,21) %}<option value="{{m}}" {{ 'selected' if m==8 else '' }}>{{m}}</option>{% endfor %}
            <option value="30">30</option>
            <option value="60">60</option>
          </select>
        </div>
        <div>
          <label>Próg % dla etykiety</label>
          <input id="lab-thr" type="number" step="0.1" min="0" value="1" />
        </div>
      </div>
      <button id="btn-label-apply" class="btn primary" type="button">Nadaj etykiety</button>
    </div>
    


    <div id="list" class="list" aria-live="polite"></div>

    <div style="display:flex;gap:8px;justify-content:space-between;margin-top:10px">
      <button id="prev" class="btn" type="button">&larr; Poprzednie</button>
      <span id="pagestat" class="muted" style="align-self:center">—</span>
      <button id="next" class="btn" type="button">Następne &rarr;</button>
    </div>
  </div>

  <!-- PRAWA KOLUMNA -->
  <div class="card pane">
    <div id="detail">
      <div class="muted">Wybierz tweet z lewej listy…</div>
    </div>

    <div class="card" style="margin-top:12px;padding:8px;display:flex;gap:8px;align-items:center">
      <label for="win-min" class="muted" style="min-width:120px">Zakres wykresu:</label>
      <select id="win-min">
        <option value="5">5 min</option>
        <option value="10">10 min</option>
        <option value="15" selected>15 min</option>
        <option value="30">30 min</option>
        <option value="60">60 min</option>
      </select>
      <label style="display:flex;align-items:center;gap:6px;margin-left:8px">
        <input type="checkbox" id="pre-10">
        <span class="muted">pokaż −10 min</span>
      </label>
      <button id="win-apply" class="btn">Zastosuj</button>
    </div>

    <div id="chart" class="card" style="margin-top:12px"></div>

    <div class="card" style="margin-top:12px;padding:12px">
      <div style="display:flex;gap:8px;align-items:center;justify-content:space-between">
        <h4 style="margin:0">Overlay linii (% względem minuty tweeta)</h4>
        <div class="muted" style="font-size:12px">Zaznacz „wybierz” przy tweetach — overlay odświeża się automatycznie.</div>
      </div>
      <div id="overlay" style="height:320px;margin-top:10px"></div>
    </div>

    <div class="card" style="margin-top:12px;padding:12px">
      <h4 style="margin:0 0 6px">Zmiana ceny względem chwili tweeta</h4>
      <pre id="minute-list">—</pre>
    </div>
  </div>
</div>

<script>
  window.INITIAL_TWEET_ID = JSON.parse('{{ (initial_id or "null")|tojson|safe }}');
</script>
{% endblock %}
